<?php
/**
 * Template for displaying single Tour post
 * Giao diện giống trang chi tiết BestPrice.vn
 */

global $post;
get_header();

// ACF fields
$img           = get_field('anh_dai_dien_tour');
$gia           = get_field('gia_tour');
$thoi_gian     = get_field('thoi_gian');
$khoi_hanh     = get_field('khoi_hanh_tu');
$diem_den      = get_field('diem_den');
$phuong_tien   = get_field('phuong_tien');
$ma_tour       = get_field('ma_tour');
$mo_ta_ngan    = get_field('mo_ta_ngan');
$bao_gom       = get_field('bao_gom');
$khong_bao_gom = get_field('khong_bao_gom');
$chinh_sach    = get_field('chinh_sach');
$luu_y         = get_field('luu_y');
?>

<style>
  .tour-wrapper { max-width: 1100px; margin: 0 auto; padding: 20px; font-family: Arial; }
  .tour-header img { width: 100%; border-radius: 8px; }
  .tour-title { font-size: 28px; margin-top: 20px; }
  .tour-info-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-top: 20px; }
  .tour-summary { font-size: 16px; line-height: 1.6; }
  .tour-sidebar { background: #f9f9f9; padding: 20px; border-radius: 8px; }
  .tour-price { font-size: 24px; color: #f26522; font-weight: bold; margin-bottom: 10px; }
  .tour-meta { font-size: 14px; line-height: 1.5; }
  .tour-section { margin-top: 40px; }
  .tour-section h2 { color: #f26522; border-left: 5px solid #f26522; padding-left: 10px; margin-bottom: 20px; }
  .tour-itinerary-day { margin-bottom: 20px; }
  .tour-itinerary-day h3 { font-size: 18px; margin-bottom: 5px; }
  .tour-itinerary-day p { margin: 0; }
</style>

<div class="tour-wrapper">
  <div class="tour-header">
    <?php if ($img): ?>
      <img src="<?php echo esc_url($img['url']); ?>" alt="">
    <?php endif; ?>
    <h1 class="tour-title"><?php the_title(); ?></h1>
  </div>

  <div class="tour-info-grid">
    <div>
      <p class="tour-summary"><?php echo esc_html($mo_ta_ngan); ?></p>

      <div class="tour-section">
        <h2>Lịch trình chi tiết</h2>
        <?php if (have_rows('lich_trinh')): $i = 1; ?>
          <?php while (have_rows('lich_trinh')): the_row(); ?>
            <div class="tour-itinerary-day">
              <h3>Ngày <?php echo $i++; ?>: <?php the_sub_field('tieu_de'); ?></h3>
              <p><?php the_sub_field('noi_dung'); ?></p>
            </div>
          <?php endwhile; ?>
        <?php else: ?>
          <p>Chưa có lịch trình.</p>
        <?php endif; ?>
      </div>

      <div class="tour-section">
        <h2>Dịch vụ bao gồm</h2>
        <?php echo wp_kses_post($bao_gom); ?>
      </div>

      <div class="tour-section">
        <h2>Không bao gồm</h2>
        <?php echo wp_kses_post($khong_bao_gom); ?>
      </div>

      <div class="tour-section">
        <h2>Chính sách</h2>
        <?php echo wp_kses_post($chinh_sach); ?>
      </div>

      <div class="tour-section">
        <h2>Lưu ý</h2>
        <?php echo wp_kses_post($luu_y); ?>
      </div>
    </div>

    <div class="tour-sidebar">
      <div class="tour-price">Giá: <?php echo number_format($gia, 0, ',', '.'); ?> đ</div>
      <div class="tour-meta">
        <p><strong>Thời gian:</strong> <?php echo esc_html($thoi_gian); ?></p>
        <p><strong>Khởi hành:</strong> <?php echo esc_html($khoi_hanh); ?></p>
        <p><strong>Điểm đến:</strong> <?php echo esc_html($diem_den); ?></p>
        <p><strong>Phương tiện:</strong> <?php echo esc_html($phuong_tien); ?></p>
        <p><strong>Mã tour:</strong> <?php echo esc_html($ma_tour); ?></p>
      </div>
    </div>
  </div>
</div>

<?php get_footer(); ?>
