<?php
/**
 * Template for single hotel post type: single-khach_san.php
 */

get_header();
$post_id = get_the_ID();
$gia = get_field('gia', $post_id);
$diem = get_field('diem_danh_gia', $post_id);
$so_danh_gia = get_field('so_danh_gia', $post_id);
$tien_ich = get_field('tien_ich', $post_id);
$noi_bat = get_field('noi_bat', $post_id);
?>

<div style="max-width:1140px;margin:auto;padding:24px;">
  <!-- Ảnh đại diện -->
  <div style="display:flex;gap:16px;">
    <?php if (has_post_thumbnail()) : ?>
      <div style="flex:1;">
        <?php the_post_thumbnail('full', ['style'=>'width:100%;border-radius:12px;']); ?>
      </div>
    <?php endif; ?>
    <div style="flex:1;display:flex;flex-direction:column;justify-content:space-between;">
      <h1><?php the_title(); ?></h1>
      <div style="font-size:14px;">
        <strong style="color:green;font-size:18px;"><?php echo $diem; ?></strong>
        <span style="margin-left:8px;">Tuyệt vời - <?php echo $so_danh_gia; ?> đánh giá</span>
      </div>
      <div style="color:#e53935;font-size:20px;font-weight:bold;margin:8px 0;">
        <?php echo number_format($gia, 0, ',', '.'); ?>đ
      </div>
      <a href="#hang-phong" style="background:#e1703a;color:white;padding:12px 24px;border-radius:8px;text-align:center;max-width:200px;">Xem giá phòng</a>
    </div>
  </div>

  <!-- Tabs chuyển mục -->
  <ul style="display:flex;list-style:none;padding:0;margin:24px 0;gap:24px;border-bottom:2px solid #eee;">
    <li><a href="#tien-ich">Tiện ích</a></li>
    <li><a href="#noi-bat">Điểm nổi bật</a></li>
    <li><a href="#hang-phong">Hạng phòng</a></li>
    <li><a href="#noi-dung">Đánh giá & Thông tin</a></li>
  </ul>

  <!-- Tiện ích -->
  <div id="tien-ich">
    <h2>Tiện ích khách sạn</h2>
    <?php if ($tien_ich): ?>
      <div style="columns:3;-webkit-columns:3;-moz-columns:3;max-height:150px;overflow:hidden;" id="list-tien-ich">
        <ul style="padding-left:20px;">
        <?php foreach ($tien_ich as $ti): ?>
          <li><?php echo esc_html($ti); ?></li>
        <?php endforeach; ?>
        </ul>
      </div>
      <button onclick="document.getElementById('list-tien-ich').style.maxHeight='none';this.style.display='none';" style="margin-top:10px;background:none;color:#e1703a;border:none;cursor:pointer;">Xem thêm</button>
    <?php endif; ?>
  </div>

  <!-- Điểm nổi bật -->
  <div id="noi-bat" style="background:#fff5e6;border-left:5px solid #ffc107;padding:16px;margin:24px 0;border-radius:8px;">
    <h2 style="color:#e1703a;margin-top:0;">Điểm nổi bật <?php the_title(); ?></h2>
    <ul style="padding-left:20px;">
      <?php foreach (explode("\n", $noi_bat) as $line): ?>
        <li><?php echo esc_html($line); ?></li>
      <?php endforeach; ?>
    </ul>
  </div>

  <!-- Hạng phòng -->
  <div id="hang-phong">
    <h2>Danh sách phòng</h2>
    <?php for ($i = 1; $i <= 4; $i++): ?>
      <?php if (have_rows("phan_loai_phong_{$i}")): ?>
<?php while (have_rows("phan_loai_phong_{$i}")) : the_row(); ?>
          <div style="display:flex;gap:16px;margin-bottom:24px;">
            <div style="flex:0 0 200px;">
              <?php $img = get_sub_field('anh_phong'); if ($img): ?>
                ￼
              <?php endif; ?>
            </div>
            <div style="flex:1;">
              <h3><?php the_sub_field('ten_phong'); ?></h3>
              <p><?php the_sub_field('dien_tich'); ?> m2 - <?php the_sub_field('huong'); ?></p>
              <p>Giường: <?php the_sub_field('giuong'); ?> - Số người: <?php the_sub_field('so_nguoi'); ?></p>
              <p>Ăn sáng: <?php the_sub_field('an_sang'); ?></p>
              <p>Ăn 3 bữa: <?php the_sub_field('an_3_bua'); ?></p>
              <p style="font-weight:bold;color:#e53935;margin-top:8px;">
                <?php echo number_format(get_sub_field('gia_phong'), 0, ',', '.'); ?>đ
              </p>
            </div>
          </div>
        <?php endwhile; ?>
      <?php endif; ?>
    <?php endfor; ?>
  </div>

  <!-- Nội dung bài viết -->
  <div id="noi-dung" style="margin-top:40px;">
    <h2>Đánh giá của Khách hàng</h2>
    <?php the_content(); ?>
  </div>
</div>

<?php get_footer(); ?>
