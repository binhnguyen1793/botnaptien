<div class="tour-search-wrapper">
    <form onsubmit="return redirectToVungMien(event);" class="tour-search-form">
        <div class="tour-search-title">Tìm tour giá tốt</div>

        <!-- Địa điểm -->
        <div class="form-group">
            <label>ĐỊA ĐIỂM</label>
            <select name="diadiem" required>
                <option value="">Bạn muốn đi đâu?</option>
                <?php
                $terms = get_terms([
                    'taxonomy' => 'vung_mien_tour',
                    'hide_empty' => false,
                ]);
                foreach ($terms as $term) {
                    $slug_parts = [];
                    $current = $term;
                    while ($current && $current->parent != 0) {
                        array_unshift($slug_parts, $current->slug);
                        $current = get_term($current->parent, 'vung_mien_tour');
                    }
                    if ($current) {
                        array_unshift($slug_parts, $current->slug);
                    }
                    $full_slug = implode('/', $slug_parts);
                    echo '<option value="' . esc_attr($term->slug) . '" data-full-slug="' . esc_attr($full_slug) . '">' . esc_html($term->name) . '</option>';
                }
                ?>
            </select>
        </div>

        <!-- Khởi hành -->
        <div class="form-group">
            <label>KHỞI HÀNH TỪ</label>
            <select name="khoihanh" required>
                <option value="">Vui lòng chọn</option>
                <option value="ha-noi">Hà Nội</option>
                <option value="ho-chi-minh">Hồ Chí Minh</option>
                <option value="da-nang">Đà Nẵng</option>
                <option value="hai-phong">Hải Phòng</option>
            </select>
        </div>

        <!-- Nút -->
        <div class="form-group" style="flex: 0 0 auto;">
            <button type="submit">Tìm ngay</button>
        </div>
    </form>
</div>

<style>
.tour-search-wrapper {
    max-width: 888px;
    margin: 0 auto;
    padding: 0 16px;
}

.tour-search-form {
    background: #fff;
    padding: 24px 28px;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    align-items: flex-end;
    justify-content: space-between;
}

.tour-search-title {
    width: 100%;
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin-bottom: 8px;
    border-bottom: 1px solid #eee;
    padding-bottom: 8px;
}

.form-group {
    flex: 1 1 calc(33.333% - 10px);
    display: flex;
    flex-direction: column;
}

.form-group label {
    font-size: 12px;
    font-weight: 600;
    color: #999;
    text-transform: uppercase;
    margin-bottom: 4px;
}

.form-group select {
    padding: 10px 14px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 14px;
    color: #333;
}

.form-group select:invalid {
    color: #999;
}

.form-group button {
    padding: 12px 24px;
    background-color: #e1703a;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    font-size: 15px;
    cursor: pointer;
}

@media (max-width: 768px) {
    .tour-search-form {
        flex-direction: column;
        align-items: stretch;
    }
    .form-group {
        flex: 1 1 100%;
    }
    .form-group button {
        width: 100%;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector('.tour-search-form');
    form.addEventListener('submit', function (e) {
        e.preventDefault();
        const select = form.querySelector('[name="diadiem"]');
        const slug = select.options[select.selectedIndex].getAttribute('data-full-slug');
        if (slug) {
            window.location.href = '/vung_mien_tour/' + slug + '/';
        }
    });
});
</script>
