function updateHotelPrice() {
    const nguoiLon = parseInt(document.getElementById('nguoi_lon').value || 0);
    const treEm = parseInt(document.getElementById('tre_em').value || 0);
    const paymentType = parseInt(document.getElementById('payment_type').value || 0);
    const checkinEl = document.getElementById('checkin');
    const checkoutEl = document.getElementById('checkout');

    const checkin = new Date(checkinEl.value);
    const checkout = new Date(checkoutEl.value);

    if (checkin && checkout && checkout <= checkin) {
        alert("Ngày trả phòng phải sau ngày nhận phòng.");
        checkoutEl.value = ""; // Reset ngày trả
        document.getElementById('final-price').innerText = '0 đ';
        document.getElementById('listed-price').innerText = '0 đ';
        return;
    }

    let days = Math.ceil((checkout - checkin) / (1000 * 60 * 60 * 24));
    if (isNaN(days) || days <= 0) days = 1;

    const listedPrice = days * ((nguoiLon * basePrice) + (treEm * basePrice * 0.5));
    let finalPrice = listedPrice;

    if (paymentType === 100) {
        finalPrice *= 0.8;
    } else if (paymentType === 30) {
        finalPrice *= 0.3;
    }

    calculatedAmount = Math.round(finalPrice);
    document.getElementById('final-price').innerText = calculatedAmount.toLocaleString('vi-VN') + ' đ';
    document.getElementById('listed-price').innerText = Math.round(listedPrice).toLocaleString('vi-VN') + ' đ';
}
