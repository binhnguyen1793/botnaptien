<div class="container"> 
<?php if (have_rows('bang_gia')): ?>
<section id="bang-gia-tour">
  <h2>üìÖ B·∫£ng gi√° tour</h2>

  <?php
    $months = [];
    $rows = get_field('bang_gia');
    foreach ($rows as $row) {
      $ngay = $row['ngay_khoi'];
      if ($ngay) {
        $month_key = date('Y-m', strtotime($ngay));
        $months[$month_key] = 'Th√°ng ' . (int)date('m', strtotime($ngay));
      }
    }
  ?>

  <div class="month-tabs">
    <button class="tab-btn active" data-month="all">T·∫•t c·∫£</button>
    <?php foreach ($months as $key => $label): ?>
      <button class="tab-btn" data-month="<?php echo esc_attr($key); ?>"><?php echo esc_html($label); ?></button>
    <?php endforeach; ?>
  </div>

  <div class="table-wrapper">
    <table class="price-table">
      <thead>
        <tr>
          <th>Ng√†y kh·ªüi h√†nh</th>
          <th>H·∫°ng tour</th>
          <th>Gi√° tour</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <?php foreach ($rows as $row): 
          $ngay = $row['ngay_khoi'];
          $hang = $row['hang_tour'];
          $gia = $row['gia_tour'];
          $con_cho = $row['con_cho'];
          $thang = $ngay ? date('Y-m', strtotime($ngay)) : '';
        ?>
        <tr data-month="<?php echo esc_attr($thang); ?>">
          <td>
            <?php echo $ngay ? date('Y-m-d', strtotime($ngay)) : ''; ?><br>
            <span class="<?php echo ($con_cho === 'con') ? 'available' : 'unavailable'; ?>">
              <?php echo ($con_cho === 'C√≤n ch·ªó') ? 'C√≤n ch·ªó' : 'K√≠n ch·ªó'; ?>
            </span>
          </td>
          <td><?php echo esc_html($hang); ?></td>
          <td>
            <strong><?php echo is_numeric($gia) ? number_format($gia, 0, ',', '.') . 'ƒë' : 'Li√™n h·ªá'; ?></strong><br>
            <small>+ <?php echo is_numeric($gia) ? number_format($gia * 0.01, 0, ',', '.') . ' ƒëi·ªÉm' : ''; ?></small>
          </td>
          <td>
            <?php if ($con_cho === 'C√≤n ch·ªó'): ?>
              <a href="/thanh-toan?price=<?php echo esc_attr($gia); ?>" class="btn-mua-ngay">Gi·ªØ ch·ªó ngay</a>
            <?php else: ?>
              <a href="#yeu-cau" class="btn-yeu-cau">G·ª≠i y√™u c·∫ßu</a>
            <?php endif; ?>
          </td>
        </tr>
        <?php endforeach; ?>
      </tbody>
    </table>
  </div>
</section>

<?php else: ?>
<!-- M·∫∑c ƒë·ªãnh hi·ªÉn th·ªã b·∫£ng tr·ªëng khi kh√¥ng c√≥ d·ªØ li·ªáu -->
<section id="bang-gia-tour">
  <h2>üìÖ B·∫£ng gi√° tour</h2>
  <div class="table-wrapper">
    <table class="price-table">
      <thead>
        <tr>
          <th>Ng√†y kh·ªüi h√†nh</th>
          <th>H·∫°ng gi√° combo</th>
          <th>Gi√° combo</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td></td>
          <td><button class="btn-mua-ngay">ƒê·∫∑t ngay</button></td>
          <td></td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
<?php endif; ?>
</div>


.price-table td {
  text-align: center;
  vertical-align: middle;
}
.btn-mua-ngay {
  background: #ffc107;
  color: #000;
  padding: 6px 12px;
  border: none;
  border-radius: 3px;
  font-weight: bold;
}
